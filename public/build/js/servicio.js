!function(){!async function(){try{const o=`/api/servicios?id=${a()}`,t=await fetch(o),n=await t.json();e=n.servicio,i()}catch(e){console.log(e)}}();let e=[];const o="location.origin";function i(){if(function(){const e=document.querySelector("#listado-servicios");for(;e.firstChild;)e.removeChild(e.firstChild)}(),0===e.length){const e=document.querySelector("#noServicio"),o=document.createElement("P");return o.textContent="No hay Servicios",o.classList.add("no-servicios"),void e.appendChild(o)}e.forEach((e=>{document.querySelector("#tabla").classList.add("mostrar");const o=document.createElement("TR");o.dataset.servicioId=e.id;const i=document.createElement("TD");i.textContent=e.servicio,i.classList.add("pointer"),i.ondblclick=function(){t(!0,{...e})};const n=document.createElement("TD");n.textContent=e.comentarios;const c=document.createElement("TD");c.textContent=e.fecha,o.appendChild(i),o.appendChild(n),o.appendChild(c);document.querySelector("#listado-servicios").appendChild(o)}))}function t(t=!1,r={}){const s=document.createElement("DIV");s.classList.add("modal"),s.innerHTML=`\n        \n            <form action="" class="formulario nuevo-servicio">\n                <legend>${t?"Editar Servicio":"A침adir Servicio"}</legend>\n\n                <div class="grid">\n                    <div class="campo">\n                        <label for="servicio">Servicio: </label>\n                        <input \n                            value="${r.servicio?r.servicio:""}"\n                            placeholder="${r.servicio?"Editar servicio":"A침adir servicio"}" \n                            name="servicio" \n                            id="servicio" \n                            type="text"\n                        >\n                    </div>\n\n                    <div class="campo">\n                        <label for="comentarios">Comentarios: </label>\n                        <textarea name="comentarios" id="comentarios">${r.comentarios?r.comentarios:""}</textarea>\n                    </div>\n\n                    <div class="campo">\n                        <label for="fecha">Fecha: </label>\n                        <input \n                            value="${r.fecha?r.fecha:""}"\n                            placeholder="${r.fecha?"Editar aaaa-mm-dd":"aaaa-mm-dd"}" \n                            name="fecha" \n                            id="fecha" \n                            type="text"\n                        >\n                    </div>\n                </div>\n\n                <div class="opciones">\n                    <input \n                        class="submit-nuevo-servicio" \n                        type="submit" \n                        value="${r.servicio?"Actualizar Servicio":"A침adir Servicio"}"\n                    >\n                    <button \n                        type="button" \n                        id="cerrar-servicio" \n                        class="cerrar-servicio">\n                        Cancelar\n                    </button>\n                </div>\n            </form>        \n        `,setTimeout((()=>{document.querySelector(".formulario").classList.add("animar")}),300),s.addEventListener("click",(function(d){if(d.preventDefault(),d.target.classList.contains("cerrar-servicio")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout((()=>{s.remove()}),300)}if(d.target.classList.contains("submit-nuevo-servicio")){const s=document.querySelector("#servicio").value.trim(),d=document.querySelector("#comentarios").value.trim(),l=document.querySelector("#fecha").value.trim(),m=/^\d{4}-\d{2}-\d{2}$/;if(""===s&&""===d&&""===l)return void c("Todos los campos son obligatorios");if(""===s)return void c("Es obligatorio el campo: Servicio");if(""===d)return void c("Es obligatorio el campo: Comentarios");if(""===l)return void c("Es obligatorio el campo: Fecha");if(!m.test(l))return void c("Formato de fecha inv치lido en el campo: Fecha. Por favor, use AAAA-MM-DD. Ejemplo: 2024-01-31");t?(r.servicio=s,r.comentarios=d,r.fecha=l,async function(t){const{vehiculo_id:r,id:s,servicio:d,comentarios:l,fecha:m}=t,u=new FormData;u.append("id",s),u.append("servicio",d),u.append("comentarios",l),u.append("fecha",m),u.append("vehiculo_id",a());try{const t=`${o}/api/servicio/actualizar`,a=await fetch(t,{method:"POST",body:u}),r=await a.json();if("error"===r.respuesta.tipo)c(r.respuesta.mensaje);else if("exito"===r.respuesta.tipo){n(r.respuesta.mensaje);const o=document.querySelector(".modal");o&&o.remove(),e=e.map((e=>(e.id===s&&(e.servicio=d,e.comentarios=l,e.fecha=m),e))),i()}}catch(e){console.log(e)}}(r)):async function(t,r,s){const d=new FormData;d.append("servicio",t),d.append("comentarios",r),d.append("fecha",s),d.append("vehiculo_id",a());try{const a=`${o}/api/servicio`,l=await fetch(a,{method:"POST",body:d}),m=await l.json();if("error"===m.tipo)c(m.mensaje);else if("exito"===m.tipo){n(m.mensaje);const o=document.querySelector(".modal");setTimeout((()=>{o.remove()}),1500);const c={id:String(m.id),servicio:t,comentarios:r,fecha:s,vehiculo_id:m.vehiculo_id};e=[...e,c],i()}}catch(e){console.log(e)}}(s,d,l)}})),document.querySelector(".dashboard").appendChild(s)}function n(e){Swal.fire({position:"center",icon:"success",title:e,showConfirmButton:!1,timer:1500})}function c(e){Swal.fire({icon:"error",title:"Oops...",text:e})}function a(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}document.querySelector("#agregar-servicio").addEventListener("click",(function(){t(!1)}))}();